<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Dashboard</h1>
        <button class="btn" onclick="window.location.href='add.html'">Add Quiz</button>
        <button class="btn" onclick="window.location.href='leaderboard.html'">View Leaderboard</button>
        <button class="btn" onclick="logout()">Logout</button>
        <div id="examsList"></div>
    </div>

    <script>
        const auth = firebase.auth();

        function logout() {
            auth.signOut().then(() => window.location.href = 'index.html').catch(error => console.error('Logout error:', error));
        }

        function loadExams() {
            const userId = auth.currentUser.uid;
            firebase.database().ref(`exams/${userId}`).once('value').then(snapshot => {
                const examsList = document.getElementById('examsList');
                examsList.innerHTML = '';
                snapshot.forEach(childSnapshot => {
                    const examData = childSnapshot.val();
                    const examKey = childSnapshot.key;
                    examsList.innerHTML += `<div><strong>${examData.title}</strong> <button onclick="startQuiz('${examKey}')">Play Quiz</button></div>`;
                });
            });
        }

        function startQuiz(examKey) {
            localStorage.setItem('currentExam', examKey);
            window.location.href = 'play.html';
        }

        window.onload = function() {
            auth.onAuthStateChanged(user => {
                if (user) {
                    loadExams();
                } else {
                    window.location.href = 'index.html';
                }
            });
        };
    </script>
</body>
</html>
